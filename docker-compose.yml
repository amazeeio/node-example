version: '2.3'

x-environment:
  &default-environment
    # Route that should be used locally, if you are using pygmy, this route *must* end with .docker.amazee.io
    LAGOON_ROUTE: &default-url http://${COMPOSE_PROJECT_NAME:-node-example-simple}.docker.amazee.io

services:
  node:
    networks:
      - amazeeio-network
      - default
    build:
      context: .
      dockerfile: node.dockerfile
    labels:
      lagoon.type: node
      lando.type: node
    ports:
      - '3000'
    environment:
      << : *default-environment # loads the defined environment variables from the top
      LAGOON_LOCALDEV_HTTP_PORT: 3000

networks:
  amazeeio-network:
    external: true
